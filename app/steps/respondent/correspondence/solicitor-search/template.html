{% from "button/macro.njk" import govukButton %}
{% from "common/components/formElements.html" import textField, textArea %}
{% extends "question.html" %}
{% block question %}
{{ content.question | safe }}
{% endblock %}

{% block form %}
<div class="govuk-body">
  <fieldset id="respondentSolicitorRepresented" class="govuk-fieldset">
  <legend class="govuk-fieldset__legend visually-hidden">{{ content.question | safe }}</legend>

     {# Solicitors firms search section #}
    <div class="govuk-form-group {{ 'govuk-form-group--error' if fields.respondentSolicitorFirm.error }}">
      {{ errorsFor(fields.respondentSolicitorFirm) }}

      {{ textField(
      name = 'respondentSolicitorFirm',
      field = fields.respondentSolicitorFirm,
      label = content.solicitorFirmLabel,
      boldLabel = true
      ) }}

      {{ govukButton({
      text: content.searchButton,
      classes: 'govuk-button govuk-!-margin-bottom-1 govuk-!-margin-top-1',
      preventDoubleClick: true
      }) }}
    </div>

    {# Solicitors firms search result section - Items found #}
    <div class="govuk-form-group">
      {% if session.organisations.length %}  
      <h2 class="govuk-label--s govuk-label">Results</h2>
      <ol class="divorce-organisation-search-result-list">
      {% for organisation in session.organisations %}
        <li class="govuk-grid-row divorce-organisation-search-result-list__item">
          <div class="govuk-grid-column-three-quarters">
            <p class="govuk-!-margin-0">{{ organisation.name }}
            {% set address = organisation.contactInformation | first %}
            <br>{{ address.addressLine1 }}
            <br>{{ address.townCity }}
            <br>{{ address.postCode }}
            </p>
          </div>
          <div class="govuk-grid-column-one-quarter govuk-!-padding-top-5">
            <button class="govuk-button govuk-button--secondary">
              Select
            </button>
          </div>
        </li>
        {% endfor %}
      </ol>
      {% elif not session.organisations.length %}

      {# Solicitors firms search result section - Items not found #}
      <div class="govuk-form-group">
        <p>There are no results for the firm you entered.</p>
        <p>This may be because the firm is not registered online with HMCTS.</p>
        <p>You can check the spelling and search again, or enter the details manually.</p>
        <button class="govuk-button govuk-button--secondary govuk-!-margin-top-0">
          Enter details manually
        </button>
      </div>
      {% endif %}
    </div>

    <div class="govuk-inset-text">
      <p>If you can't see the firm listed then you can enter the details manually.</p>

      <button class="govuk-button govuk-button--secondary govuk-!-margin-top-0">
        Enter details manually
      </button>
    </div>

    {# Solicitors firms manual entry section #}
    <div class="govuk-form-group">
      {{ textField(
        name = 'respondentSolicitorName',
        field = fields.respondentSolicitorName,
        label = content.solicitorNameLabel,
        boldLabel = true
       ) }}

      {{ textField(
      name = 'respondentSolicitorReference',
      field = fields.respondentSolicitorReference,
      label = content.solicitorReferenceLabel,
      boldLabel = true
      ) }}

      {{ textField(
        name = 'respondentSolicitorEmail',
        field = fields.respondentSolicitorEmail,
        label = content.solicitorEmailLabel,
        boldLabel = true
       ) }}

      {{ textArea(
         name = 'respondentSolicitorAddress',
         field = fields.respondentSolicitorAddress,
         label = content.solicitorFirmAddressLabel,
         boldLabel = true
       ) }}
    </div>
  </fieldset>
</div>

{% endblock %}
